{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/yisus/Desktop/Nueva carpeta/OT304-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport { DialogComponent } from 'src/app/shared/dialog/dialog.component';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/core/services/http.service\";\nimport * as i3 from \"@angular/material/dialog\";\nexport class TestimonialFormComponent {\n  constructor(fb, api, dialog) {\n    this.fb = fb;\n    this.api = api;\n    this.dialog = dialog;\n    this.formData = new FormData();\n    this.name = '';\n    this.description = '';\n    this.create = true;\n    this.show = false;\n    this.analizeObject();\n  }\n\n  ngOnInit() {\n    this.formGroup = this.fb.group({\n      name: this.obj ? [this.obj.name, [Validators.required, Validators.minLength(4)]] : ['', [Validators.required, Validators.minLength(4)]],\n      description: this.obj ? [this.obj.description, Validators.required] : ['', [Validators.required]],\n      image: ['', Validators.required]\n    });\n  }\n\n  analizeObject() {\n    if (this.obj) {\n      this.create = false;\n    }\n  }\n\n  get f() {\n    return this.formGroup.controls;\n  }\n\n  createOrEdit() {\n    var _a, _b, _c, _d;\n\n    if (this.create) {\n      this.api.post(environment.API_URL + 'testimonials', false, {\n        name: (_a = this.formGroup.get('name')) === null || _a === void 0 ? void 0 : _a.value,\n        description: (_b = this.formGroup.get('description')) === null || _b === void 0 ? void 0 : _b.value,\n        image: this.imgBase64\n      }).subscribe(res => {\n        if (res.error) {\n          this.openDialog(res.error);\n        } else {\n          this.openDialog(\"Testimonio creado con éxito.\");\n        }\n      });\n    } else {\n      this.api.put(environment.API_URL + 'testimonials/' + this.obj.id, false, {\n        name: (_c = this.formGroup.get('name')) === null || _c === void 0 ? void 0 : _c.value,\n        description: (_d = this.formGroup.get('description')) === null || _d === void 0 ? void 0 : _d.value,\n        image: this.imgBase64\n      }).subscribe(res => {\n        if (res.error) {\n          this.openDialog(res.error);\n        } else {\n          this.openDialog(\"Testimonio modificado con éxito.\");\n        }\n      });\n    }\n\n    this.show = !this.show;\n    setTimeout(() => {\n      this.show = !this.show;\n    }, 3000);\n    this.formGroup.reset();\n  }\n\n  fileOnChange(e) {\n    let imagen = e.target.files[0];\n    let allowedExtensions = /(.jpg|.png)$/i;\n\n    if (allowedExtensions.exec(imagen.name)) {\n      this.convertFileToBase64(imagen);\n    } else {\n      console.log(\"El archivo no es imagen\");\n      this.imgBase64 = null;\n      this.formGroup.controls.img.setErrors({\n        invalidExtension: true\n      });\n    }\n  }\n\n  convertFileToBase64(file) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = () => {\n        var _a;\n\n        _this.imgBase64 = (_a = reader.result) === null || _a === void 0 ? void 0 : _a.toString();\n      };\n    })();\n  }\n\n  openDialog(info) {\n    this.dialog.open(DialogComponent, {\n      data: info\n    });\n  }\n\n}\n\nTestimonialFormComponent.ɵfac = function TestimonialFormComponent_Factory(t) {\n  return new (t || TestimonialFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.HttpService), i0.ɵɵdirectiveInject(i3.MatDialog));\n};\n\nTestimonialFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TestimonialFormComponent,\n  selectors: [[\"app-testimonial-form\"]],\n  inputs: {\n    obj: \"obj\"\n  },\n  decls: 2,\n  vars: 0,\n  template: function TestimonialFormComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\");\n      i0.ɵɵtext(1, \"testimonial-form works!\");\n      i0.ɵɵelementEnd();\n    }\n  },\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ0ZXN0aW1vbmlhbC1mb3JtLmNvbXBvbmVudC5zY3NzIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Validators","DialogComponent","environment","TestimonialFormComponent","constructor","fb","api","dialog","FormData","analizeObject","ngOnInit","formGroup","group","name","obj","required","minLength","description","image","create","f","controls","createOrEdit","post","API_URL","get","_a","value","_b","imgBase64","subscribe","res","error","openDialog","put","id","_c","_d","show","setTimeout","reset","fileOnChange","e","imagen","target","files","allowedExtensions","exec","convertFileToBase64","console","log","img","setErrors","invalidExtension","file","reader","FileReader","readAsDataURL","onload","result","toString","info","open","data","i0","selectors","inputs","decls","vars","template"],"sourceRoot":"","sources":["C:\\Users\\yisus\\Desktop\\Nueva carpeta\\OT304-client\\src\\app\\features\\pages\\testimonials\\testimonial-form\\testimonial-form.component.ts","C:\\Users\\yisus\\Desktop\\Nueva carpeta\\OT304-client\\src\\app\\features\\pages\\testimonials\\testimonial-form\\testimonial-form.component.html"],"sourcesContent":["\r\nimport { Component, Input, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { HttpService } from 'src/app/core/services/http.service';\r\nimport { DialogComponent } from 'src/app/shared/dialog/dialog.component';\r\nimport { environment } from 'src/environments/environment';\r\n\r\n@Component({\r\n  selector: 'app-testimonial-form',\r\n  templateUrl: './testimonial-form.component.html',\r\n  styleUrls: ['./testimonial-form.component.scss']\r\n})\r\nexport class TestimonialFormComponent implements OnInit {\r\n\r\n  // @Input() obj : any = {\r\n  //   id:466,\r\n  //   name: \"Editanding\",\r\n  //   image: \"http://ongapi.alkemy.org/storage/dAtRc9eTah.jpeg\",\r\n  //   description: \"<p>CKEditor Editanding pruebadd</p>\",\r\n\r\n  // };\r\n\r\n  @Input() obj : any;\r\n  \r\n  formData : FormData = new FormData();\r\n  formGroup !: FormGroup;\r\n  name : string = '';\r\n  description : string = '';\r\n  imgBase64 !: any;\r\n  create : boolean = true;\r\n  show : boolean = false;\r\n\r\n  constructor(private fb : FormBuilder, private api : HttpService, private dialog:MatDialog) {\r\n\r\n    this.analizeObject();\r\n\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n\r\n    this.formGroup = this.fb.group({\r\n      name: this.obj ? [this.obj.name, [Validators.required, Validators.minLength(4)]] :['', [Validators.required, Validators.minLength(4)]],\r\n      description: this.obj ? [this.obj.description, Validators.required] :  ['', [Validators.required]],\r\n      image: ['', Validators.required],\r\n    });\r\n\r\n  }\r\n\r\n  analizeObject(){\r\n    if(this.obj){\r\n      this.create = false;\r\n    }\r\n  }\r\n\r\n  \r\n  get f(){\r\n    return this.formGroup.controls;\r\n  }\r\n\r\n  createOrEdit(){\r\n\r\n    if(this.create){\r\n    \r\n      this.api.post(environment.API_URL + 'testimonials',false, {\r\n        name: this.formGroup.get('name')?.value,\r\n        description:this.formGroup.get('description')?.value,\r\n        image: this.imgBase64\r\n      })\r\n      .subscribe((res : any)=>{\r\n        \r\n        if(res.error){\r\n\r\n          this.openDialog(res.error);\r\n\r\n        }else{\r\n\r\n           this.openDialog(\"Testimonio creado con éxito.\");\r\n        }\r\n      });\r\n    \r\n    }else{\r\n\r\n      this.api.put( environment.API_URL+ 'testimonials/' + this.obj.id,false, {\r\n        name: this.formGroup.get('name')?.value,\r\n        description:this.formGroup.get('description')?.value,\r\n        image: this.imgBase64,\r\n      })\r\n      .subscribe((res : any )=>{\r\n        if(res.error){\r\n\r\n          this.openDialog(res.error);\r\n\r\n        }else{\r\n\r\n          this.openDialog(\"Testimonio modificado con éxito.\");\r\n        }\r\n      });\r\n    }\r\n\r\n    \r\n    this.show = !this.show;\r\n    setTimeout(() => {\r\n\r\n    this.show = !this.show;\r\n\r\n    }, 3000);\r\n\r\n    this.formGroup.reset();\r\n  }\r\n\r\n  fileOnChange(e: any) {\r\n\r\n    let imagen = e.target.files[0];\r\n    let allowedExtensions = /(.jpg|.png)$/i;\r\n\r\n    if (allowedExtensions.exec(imagen.name)) {\r\n      this.convertFileToBase64(imagen);\r\n    }\r\n    else {\r\n      console.log(\"El archivo no es imagen\");\r\n      this.imgBase64 = null;\r\n      this.formGroup.controls.img.setErrors({\r\n        invalidExtension: true\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  async convertFileToBase64(file: any) {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      this.imgBase64 = reader.result?.toString();\r\n    };\r\n  }\r\n\r\n  openDialog(info :string){\r\n    this.dialog.open(DialogComponent,{\r\n      data : info\r\n    });\r\n  }\r\n\r\n}\r\n","<p>testimonial-form works!</p>\r\n"]},"metadata":{},"sourceType":"module"}