{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/yisus/Desktop/Nueva carpeta/OT304-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport { DialogComponent } from 'src/app/shared/dialog/dialog.component';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/core/services/http.service\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"ckeditor4-angular\";\n\nfunction TestimonialFormComponent_h1_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \"Cree su testimonio\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \" Edite su testimonio \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_div_9_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtext(1, \"El nombre debe tener al menos 4 caracteres.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_div_9_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"El nombre es requerido.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtemplate(1, TestimonialFormComponent_div_9_div_1_Template, 2, 0, \"div\", 7);\n    i0.ɵɵtemplate(2, TestimonialFormComponent_div_9_div_2_Template, 2, 0, \"div\", 16);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.f[\"name\"].errors == null ? null : ctx_r3.f[\"name\"].errors[\"minlength\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.f[\"name\"].errors == null ? null : ctx_r3.f[\"name\"].errors[\"required\"]);\n  }\n}\n\nfunction TestimonialFormComponent_div_13_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"El contenido es requerido.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtemplate(1, TestimonialFormComponent_div_13_div_1_Template, 2, 0, \"div\", 16);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.f[\"description\"].errors == null ? null : ctx_r4.f[\"description\"].errors[\"required\"]);\n  }\n}\n\nfunction TestimonialFormComponent_div_17_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"La imagen es obligatoria.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15);\n    i0.ɵɵtemplate(1, TestimonialFormComponent_div_17_div_1_Template, 2, 0, \"div\", 16);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.f[\"image\"].errors == null ? null : ctx_r5.f[\"image\"].errors[\"required\"]);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"btnError\": a0\n  };\n};\n\nfunction TestimonialFormComponent_button_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 17);\n    i0.ɵɵtext(1, \"Crear\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r6.formGroup.invalid))(\"disabled\", ctx_r6.formGroup.invalid);\n  }\n}\n\nfunction TestimonialFormComponent_ng_template_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 17);\n    i0.ɵɵtext(1, \"Editar\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r8.formGroup.invalid))(\"disabled\", ctx_r8.formGroup.invalid);\n  }\n}\n\nfunction TestimonialFormComponent_div_21_label_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1, \"Testimonio creado\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_div_21_label_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1, \"Testimonio editado\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction TestimonialFormComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtemplate(1, TestimonialFormComponent_div_21_label_1_Template, 2, 0, \"label\", 16);\n    i0.ɵɵtemplate(2, TestimonialFormComponent_div_21_label_2_Template, 2, 0, \"label\", 16);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r9.create);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r9.create);\n  }\n}\n\nexport class TestimonialFormComponent {\n  constructor(fb, api, dialog) {\n    this.fb = fb;\n    this.api = api;\n    this.dialog = dialog;\n    this.formData = new FormData();\n    this.name = '';\n    this.description = '';\n    this.create = true;\n    this.show = false;\n    this.analizeObject();\n  }\n\n  ngOnInit() {\n    this.formGroup = this.fb.group({\n      name: this.obj ? [this.obj.name, [Validators.required, Validators.minLength(4)]] : ['', [Validators.required, Validators.minLength(4)]],\n      description: this.obj ? [this.obj.description, Validators.required] : ['', [Validators.required]],\n      image: ['', Validators.required]\n    });\n  }\n\n  analizeObject() {\n    if (this.obj) {\n      this.create = false;\n    }\n  }\n\n  get f() {\n    return this.formGroup.controls;\n  }\n\n  createOrEdit() {\n    var _a, _b, _c, _d;\n\n    if (this.create) {\n      this.api.post(environment.API_URL + 'testimonials', false, {\n        name: (_a = this.formGroup.get('name')) === null || _a === void 0 ? void 0 : _a.value,\n        description: (_b = this.formGroup.get('description')) === null || _b === void 0 ? void 0 : _b.value,\n        image: this.imgBase64\n      }).subscribe(res => {\n        if (res.error) {\n          this.openDialog(res.error);\n        } else {\n          this.openDialog(\"Testimonio creado con éxito.\");\n        }\n      });\n    } else {\n      this.api.put(environment.API_URL + 'testimonials/' + this.obj.id, false, {\n        name: (_c = this.formGroup.get('name')) === null || _c === void 0 ? void 0 : _c.value,\n        description: (_d = this.formGroup.get('description')) === null || _d === void 0 ? void 0 : _d.value,\n        image: this.imgBase64\n      }).subscribe(res => {\n        if (res.error) {\n          this.openDialog(res.error);\n        } else {\n          this.openDialog(\"Testimonio modificado con éxito.\");\n        }\n      });\n    }\n\n    this.show = !this.show;\n    setTimeout(() => {\n      this.show = !this.show;\n    }, 3000);\n    this.formGroup.reset();\n  }\n\n  fileOnChange(e) {\n    let imagen = e.target.files[0];\n    let allowedExtensions = /(.jpg|.png)$/i;\n\n    if (allowedExtensions.exec(imagen.name)) {\n      this.convertFileToBase64(imagen);\n    } else {\n      console.log(\"El archivo no es imagen\");\n      this.imgBase64 = null;\n      this.formGroup.controls.img.setErrors({\n        invalidExtension: true\n      });\n    }\n  }\n\n  convertFileToBase64(file) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = () => {\n        var _a;\n\n        _this.imgBase64 = (_a = reader.result) === null || _a === void 0 ? void 0 : _a.toString();\n      };\n    })();\n  }\n\n  openDialog(info) {\n    this.dialog.open(DialogComponent, {\n      data: info\n    });\n  }\n\n}\n\nTestimonialFormComponent.ɵfac = function TestimonialFormComponent_Factory(t) {\n  return new (t || TestimonialFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.HttpService), i0.ɵɵdirectiveInject(i3.MatDialog));\n};\n\nTestimonialFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TestimonialFormComponent,\n  selectors: [[\"app-testimonial-form\"]],\n  inputs: {\n    obj: \"obj\"\n  },\n  decls: 22,\n  vars: 9,\n  consts: [[1, \"contenedor\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseBlock\", \"\"], [1, \"formulario\"], [3, \"formGroup\", \"ngSubmit\"], [\"for\", \"name\"], [\"type\", \"text\", \"formControlName\", \"name\", \"name\", \"name\"], [\"class\", \"error\", 4, \"ngIf\"], [\"for\", \"description\"], [\"data\", \"<p>Hello, world!</p>\", \"formControlName\", \"description\", \"name\", \"description\"], [\"for\", \"image\"], [\"type\", \"file\", \"formControlName\", \"image\", \"name\", \"image\", 3, \"change\"], [\"type\", \"submit\", 3, \"ngClass\", \"disabled\", 4, \"ngIf\", \"ngIfElse\"], [\"editBlock\", \"\"], [\"class\", \"exito\", 4, \"ngIf\"], [1, \"error\"], [4, \"ngIf\"], [\"type\", \"submit\", 3, \"ngClass\", \"disabled\"], [1, \"exito\"]],\n  template: function TestimonialFormComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, TestimonialFormComponent_h1_1_Template, 2, 0, \"h1\", 1);\n      i0.ɵɵtemplate(2, TestimonialFormComponent_ng_template_2_Template, 2, 0, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"form\", 4);\n      i0.ɵɵlistener(\"ngSubmit\", function TestimonialFormComponent_Template_form_ngSubmit_5_listener() {\n        return ctx.createOrEdit();\n      });\n      i0.ɵɵelementStart(6, \"label\", 5);\n      i0.ɵɵtext(7, \"Su nombre:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(8, \"input\", 6);\n      i0.ɵɵtemplate(9, TestimonialFormComponent_div_9_Template, 3, 2, \"div\", 7);\n      i0.ɵɵelementStart(10, \"label\", 8);\n      i0.ɵɵtext(11, \"Descripci\\u00F3n del testimonio :\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(12, \"ckeditor\", 9);\n      i0.ɵɵtemplate(13, TestimonialFormComponent_div_13_Template, 2, 1, \"div\", 7);\n      i0.ɵɵelementStart(14, \"label\", 10);\n      i0.ɵɵtext(15, \"Foto suya:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"input\", 11);\n      i0.ɵɵlistener(\"change\", function TestimonialFormComponent_Template_input_change_16_listener($event) {\n        return ctx.fileOnChange($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(17, TestimonialFormComponent_div_17_Template, 2, 1, \"div\", 7);\n      i0.ɵɵtemplate(18, TestimonialFormComponent_button_18_Template, 2, 4, \"button\", 12);\n      i0.ɵɵtemplate(19, TestimonialFormComponent_ng_template_19_Template, 2, 4, \"ng-template\", null, 13, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵtemplate(21, TestimonialFormComponent_div_21_Template, 3, 2, \"div\", 14);\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      const _r1 = i0.ɵɵreference(3);\n\n      const _r7 = i0.ɵɵreference(20);\n\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.create)(\"ngIfElse\", _r1);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"formGroup\", ctx.formGroup);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.f[\"name\"].touched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.f[\"description\"].touched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.f[\"image\"].touched);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.create)(\"ngIfElse\", _r7);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.show);\n    }\n  },\n  dependencies: [i4.NgClass, i4.NgIf, i5.CKEditorComponent, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n  styles: [\".contenedor[_ngcontent-%COMP%] {\\n  padding: 50px;\\n  font-family: \\\"Poppins\\\", sans-serif;\\n  align-items: center;\\n}\\n\\nh1[_ngcontent-%COMP%] {\\n  text-align: center;\\n}\\n\\n.formulario[_ngcontent-%COMP%] {\\n  align-items: center;\\n  display: flex;\\n  font-size: 20px;\\n  padding: 30px;\\n  justify-content: center;\\n}\\n\\nlabel[_ngcontent-%COMP%] {\\n  display: block;\\n  margin: 15px;\\n  margin-left: -2px;\\n}\\n\\nbutton[_ngcontent-%COMP%] {\\n  background-color: #FF0000;\\n  border-radius: 10px;\\n  color: white;\\n  display: block;\\n  font-family: \\\"Poppins\\\", sans-serif;\\n  font-size: 20px;\\n  margin-left: 250px;\\n  margin-top: 50px;\\n  padding: 10px;\\n}\\n\\n.error[_ngcontent-%COMP%] {\\n  font-size: 15px;\\n  color: red;\\n}\\n\\n.btnError[_ngcontent-%COMP%] {\\n  background-color: grey;\\n}\\n\\n.exito[_ngcontent-%COMP%] {\\n  color: green;\\n  font-size: 20px;\\n  text-align: center;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3RpbW9uaWFsLWZvcm0uY29tcG9uZW50LnNjc3MiLCIuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXE51ZXZhJTIwY2FycGV0YVxcT1QzMDQtY2xpZW50XFxzcmNcXGFwcFxcZmVhdHVyZXNcXHBhZ2VzXFx0ZXN0aW1vbmlhbHNcXHRlc3RpbW9uaWFsLWZvcm1cXHRlc3RpbW9uaWFsLWZvcm0uY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDSSxhQUFBO0VBQ0Esa0NBQUE7RUFDQSxtQkFBQTtBQ0NKOztBREVBO0VBQ0ksa0JBQUE7QUNDSjs7QURDQTtFQUNJLG1CQUFBO0VBQ0EsYUFBQTtFQUNBLGVBQUE7RUFDQSxhQUFBO0VBQ0EsdUJBQUE7QUNFSjs7QURDQTtFQUNJLGNBQUE7RUFDQSxZQUFBO0VBQ0EsaUJBQUE7QUNFSjs7QURDQTtFQUNJLHlCQUFBO0VBQ0EsbUJBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUNBLGtDQUFBO0VBQ0EsZUFBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxhQUFBO0FDRUo7O0FEQ0E7RUFDSSxlQUFBO0VBQ0EsVUFBQTtBQ0VKOztBRENBO0VBQ0ksc0JBQUE7QUNFSjs7QURFQTtFQUNJLFlBQUE7RUFDQSxlQUFBO0VBQ0Esa0JBQUE7QUNDSiIsImZpbGUiOiJ0ZXN0aW1vbmlhbC1mb3JtLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbnRlbmVkb3J7XHJcbiAgICBwYWRkaW5nOiA1MHB4O1xyXG4gICAgZm9udC1mYW1pbHk6ICdQb3BwaW5zJywgc2Fucy1zZXJpZjtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7ICBcclxufVxyXG5cclxuaDF7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbn1cclxuLmZvcm11bGFyaW97XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZvbnQtc2l6ZTogMjBweDtcclxuICAgIHBhZGRpbmc6IDMwcHg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxufVxyXG5cclxubGFiZWx7XHJcbiAgICBkaXNwbGF5OiBibG9jaztcclxuICAgIG1hcmdpbjogMTVweDtcclxuICAgIG1hcmdpbi1sZWZ0OiAtMnB4O1xyXG59XHJcblxyXG5idXR0b257XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkYwMDAwO1xyXG4gICAgYm9yZGVyLXJhZGl1czogMTBweDtcclxuICAgIGNvbG9yOndoaXRlO1xyXG4gICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICBmb250LWZhbWlseTogJ1BvcHBpbnMnLCBzYW5zLXNlcmlmO1xyXG4gICAgZm9udC1zaXplOiAyMHB4O1xyXG4gICAgbWFyZ2luLWxlZnQ6IDI1MHB4O1xyXG4gICAgbWFyZ2luLXRvcDogNTBweDtcclxuICAgIHBhZGRpbmc6IDEwcHg7XHJcbn1cclxuXHJcbi5lcnJvcntcclxuICAgIGZvbnQtc2l6ZTogMTVweDtcclxuICAgIGNvbG9yOnJlZDtcclxufVxyXG5cclxuLmJ0bkVycm9ye1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogZ3JleTtcclxufVxyXG5cclxuXHJcbi5leGl0b3tcclxuICAgIGNvbG9yOmdyZWVuO1xyXG4gICAgZm9udC1zaXplOiAyMHB4O1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59IiwiLmNvbnRlbmVkb3Ige1xuICBwYWRkaW5nOiA1MHB4O1xuICBmb250LWZhbWlseTogXCJQb3BwaW5zXCIsIHNhbnMtc2VyaWY7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG59XG5cbmgxIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuXG4uZm9ybXVsYXJpbyB7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZvbnQtc2l6ZTogMjBweDtcbiAgcGFkZGluZzogMzBweDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG59XG5cbmxhYmVsIHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIG1hcmdpbjogMTVweDtcbiAgbWFyZ2luLWxlZnQ6IC0ycHg7XG59XG5cbmJ1dHRvbiB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNGRjAwMDA7XG4gIGJvcmRlci1yYWRpdXM6IDEwcHg7XG4gIGNvbG9yOiB3aGl0ZTtcbiAgZGlzcGxheTogYmxvY2s7XG4gIGZvbnQtZmFtaWx5OiBcIlBvcHBpbnNcIiwgc2Fucy1zZXJpZjtcbiAgZm9udC1zaXplOiAyMHB4O1xuICBtYXJnaW4tbGVmdDogMjUwcHg7XG4gIG1hcmdpbi10b3A6IDUwcHg7XG4gIHBhZGRpbmc6IDEwcHg7XG59XG5cbi5lcnJvciB7XG4gIGZvbnQtc2l6ZTogMTVweDtcbiAgY29sb3I6IHJlZDtcbn1cblxuLmJ0bkVycm9yIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogZ3JleTtcbn1cblxuLmV4aXRvIHtcbiAgY29sb3I6IGdyZWVuO1xuICBmb250LXNpemU6IDIwcHg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Validators","DialogComponent","environment","i0","ctx_r6","ctx_r8","TestimonialFormComponent","constructor","fb","api","dialog","FormData","analizeObject","ngOnInit","formGroup","group","name","obj","required","minLength","description","image","create","f","controls","createOrEdit","post","API_URL","get","_a","value","_b","imgBase64","subscribe","res","error","openDialog","put","id","_c","_d","show","setTimeout","reset","fileOnChange","e","imagen","target","files","allowedExtensions","exec","convertFileToBase64","console","log","img","setErrors","invalidExtension","file","reader","FileReader","readAsDataURL","onload","result","toString","info","open","data","selectors","inputs","decls","vars","consts","template","ctx","_r1","_r7"],"sourceRoot":"","sources":["C:\\Users\\yisus\\Desktop\\Nueva carpeta\\OT304-client\\src\\app\\features\\pages\\testimonials\\testimonial-form\\testimonial-form.component.ts","C:\\Users\\yisus\\Desktop\\Nueva carpeta\\OT304-client\\src\\app\\features\\pages\\testimonials\\testimonial-form\\testimonial-form.component.html"],"sourcesContent":["\r\nimport { Component, Input, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { HttpService } from 'src/app/core/services/http.service';\r\nimport { DialogComponent } from 'src/app/shared/dialog/dialog.component';\r\nimport { environment } from 'src/environments/environment';\r\n\r\n@Component({\r\n  selector: 'app-testimonial-form',\r\n  templateUrl: './testimonial-form.component.html',\r\n  styleUrls: ['./testimonial-form.component.scss']\r\n})\r\nexport class TestimonialFormComponent implements OnInit {\r\n\r\n  // @Input() obj : any = {\r\n  //   id:466,\r\n  //   name: \"Editanding\",\r\n  //   image: \"http://ongapi.alkemy.org/storage/dAtRc9eTah.jpeg\",\r\n  //   description: \"<p>CKEditor Editanding pruebadd</p>\",\r\n\r\n  // };\r\n\r\n  @Input() obj : any;\r\n  \r\n  formData : FormData = new FormData();\r\n  formGroup !: FormGroup;\r\n  name : string = '';\r\n  description : string = '';\r\n  imgBase64 !: any;\r\n  create : boolean = true;\r\n  show : boolean = false;\r\n\r\n  constructor(private fb : FormBuilder, private api : HttpService, private dialog:MatDialog) {\r\n\r\n    this.analizeObject();\r\n\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n\r\n    this.formGroup = this.fb.group({\r\n      name: this.obj ? [this.obj.name, [Validators.required, Validators.minLength(4)]] :['', [Validators.required, Validators.minLength(4)]],\r\n      description: this.obj ? [this.obj.description, Validators.required] :  ['', [Validators.required]],\r\n      image: ['', Validators.required],\r\n    });\r\n\r\n  }\r\n\r\n  analizeObject(){\r\n    if(this.obj){\r\n      this.create = false;\r\n    }\r\n  }\r\n\r\n  \r\n  get f(){\r\n    return this.formGroup.controls;\r\n  }\r\n\r\n  createOrEdit(){\r\n\r\n    if(this.create){\r\n    \r\n      this.api.post(environment.API_URL + 'testimonials',false, {\r\n        name: this.formGroup.get('name')?.value,\r\n        description:this.formGroup.get('description')?.value,\r\n        image: this.imgBase64\r\n      })\r\n      .subscribe((res : any)=>{\r\n        \r\n        if(res.error){\r\n\r\n          this.openDialog(res.error);\r\n\r\n        }else{\r\n\r\n           this.openDialog(\"Testimonio creado con éxito.\");\r\n        }\r\n      });\r\n    \r\n    }else{\r\n\r\n      this.api.put( environment.API_URL+ 'testimonials/' + this.obj.id,false, {\r\n        name: this.formGroup.get('name')?.value,\r\n        description:this.formGroup.get('description')?.value,\r\n        image: this.imgBase64,\r\n      })\r\n      .subscribe((res : any )=>{\r\n        if(res.error){\r\n\r\n          this.openDialog(res.error);\r\n\r\n        }else{\r\n\r\n          this.openDialog(\"Testimonio modificado con éxito.\");\r\n        }\r\n      });\r\n    }\r\n\r\n    \r\n    this.show = !this.show;\r\n    setTimeout(() => {\r\n\r\n    this.show = !this.show;\r\n\r\n    }, 3000);\r\n\r\n    this.formGroup.reset();\r\n  }\r\n\r\n  fileOnChange(e: any) {\r\n\r\n    let imagen = e.target.files[0];\r\n    let allowedExtensions = /(.jpg|.png)$/i;\r\n\r\n    if (allowedExtensions.exec(imagen.name)) {\r\n      this.convertFileToBase64(imagen);\r\n    }\r\n    else {\r\n      console.log(\"El archivo no es imagen\");\r\n      this.imgBase64 = null;\r\n      this.formGroup.controls.img.setErrors({\r\n        invalidExtension: true\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  async convertFileToBase64(file: any) {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      this.imgBase64 = reader.result?.toString();\r\n    };\r\n  }\r\n\r\n  openDialog(info :string){\r\n    this.dialog.open(DialogComponent,{\r\n      data : info\r\n    });\r\n  }\r\n\r\n}\r\n","<div class=\"contenedor\">\r\n    \r\n    <h1 *ngIf=\"create ; else elseBlock\">Cree su testimonio</h1>\r\n    <ng-template #elseBlock> <h1> Edite su testimonio </h1> </ng-template>\r\n    <div class=\"formulario\">\r\n        <form [formGroup]=\"formGroup\" (ngSubmit)=\"createOrEdit()\">\r\n\r\n            <label for=\"name\">Su nombre:</label>\r\n            <input type=\"text\" formControlName=\"name\"  name=\"name\"/>\r\n\r\n            <div class=\"error\" *ngIf=\"f['name'].touched\">\r\n                <div class=\"error\" *ngIf=\"f['name'].errors?.['minlength']\">El nombre debe tener al menos 4 caracteres.</div>\r\n                <div *ngIf=\"f['name'].errors?.['required']\">El nombre es requerido.</div>\r\n            </div>\r\n\r\n            <label for=\"description\">Descripción del testimonio :</label>\r\n            <ckeditor data=\"<p>Hello, world!</p>\" formControlName=\"description\"  name=\"description\"></ckeditor>\r\n\r\n            <div class=\"error\" *ngIf=\"f['description'].touched\">\r\n                <div *ngIf=\"f['description'].errors?.['required']\">El contenido es requerido.</div>\r\n            </div>\r\n\r\n            <label for=\"image\">Foto suya:</label>\r\n            <input type=\"file\" formControlName=\"image\"  name=\"image\" (change)=\"fileOnChange($event)\" /> \r\n\r\n            <div class=\"error\" *ngIf=\"f['image'].touched\">\r\n                <div *ngIf=\"f['image'].errors?.['required']\">La imagen es obligatoria.</div>\r\n            </div>\r\n        \r\n\r\n            <button *ngIf=\"create; else editBlock\" [ngClass]=\"{'btnError' : formGroup.invalid}\" [disabled]=\"formGroup.invalid\" type=\"submit\">Crear</button>\r\n            <ng-template #editBlock>\r\n\r\n                <button type=\"submit\" [ngClass]=\"{'btnError' : formGroup.invalid}\" [disabled]=\"formGroup.invalid\" >Editar</button>\r\n            </ng-template>\r\n\r\n            <div class=\"exito\" *ngIf=\"show\">\r\n                <label *ngIf=\"create\">Testimonio creado</label>\r\n                <label *ngIf=\"!create\">Testimonio editado</label>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}