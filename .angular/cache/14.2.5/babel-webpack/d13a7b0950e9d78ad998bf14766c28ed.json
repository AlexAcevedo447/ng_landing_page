{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/yisus/Desktop/Nueva carpeta/OT304-client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/core/services/http.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"ckeditor4-angular\";\n\nfunction NewsFormComponent_h1_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \"Cree su novedad\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \" Edite su novedad \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_9_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1, \"El nombre debe tener al menos 4 caracteres.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_9_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"El nombre es requerido.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtemplate(1, NewsFormComponent_div_9_div_1_Template, 2, 0, \"div\", 7);\n    i0.ɵɵtemplate(2, NewsFormComponent_div_9_div_2_Template, 2, 0, \"div\", 19);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.f[\"name\"].errors == null ? null : ctx_r3.f[\"name\"].errors[\"minlength\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.f[\"name\"].errors == null ? null : ctx_r3.f[\"name\"].errors[\"required\"]);\n  }\n}\n\nfunction NewsFormComponent_div_13_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"El contenido es requerido.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtemplate(1, NewsFormComponent_div_13_div_1_Template, 2, 0, \"div\", 19);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.f[\"content\"].errors == null ? null : ctx_r4.f[\"content\"].errors[\"required\"]);\n  }\n}\n\nfunction NewsFormComponent_div_17_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"La imagen es obligatoria.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtemplate(1, NewsFormComponent_div_17_div_1_Template, 2, 0, \"div\", 19);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.f[\"image\"].errors == null ? null : ctx_r5.f[\"image\"].errors[\"required\"]);\n  }\n}\n\nfunction NewsFormComponent_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const categoria_r16 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", categoria_r16.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", categoria_r16.name, \" \");\n  }\n}\n\nfunction NewsFormComponent_div_22_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Seleccione una categor\\u00EDa.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtemplate(1, NewsFormComponent_div_22_div_1_Template, 2, 0, \"div\", 19);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.f[\"category\"].errors == null ? null : ctx_r7.f[\"category\"].errors[\"required\"]);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"btnError\": a0\n  };\n};\n\nfunction NewsFormComponent_button_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 21);\n    i0.ɵɵtext(1, \"Crear\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"disabled\", ctx_r8.formGroup.invalid)(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r8.formGroup.invalid));\n  }\n}\n\nfunction NewsFormComponent_ng_template_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 21);\n    i0.ɵɵtext(1, \"Editar\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"disabled\", ctx_r10.formGroup.invalid)(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, ctx_r10.formGroup.invalid));\n  }\n}\n\nfunction NewsFormComponent_div_26_label_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1, \"Novedad creada\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_26_label_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1, \"Novedad editada\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NewsFormComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵtemplate(1, NewsFormComponent_div_26_label_1_Template, 2, 0, \"label\", 19);\n    i0.ɵɵtemplate(2, NewsFormComponent_div_26_label_2_Template, 2, 0, \"label\", 19);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r11 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r11.create);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r11.create);\n  }\n}\n\nexport class NewsFormComponent {\n  constructor(fb, api) {\n    this.fb = fb;\n    this.api = api;\n    this.formData = new FormData();\n    this.name = '';\n    this.description = '';\n    this.create = true;\n    this.show = false;\n    this.analizeObject();\n    this.getCategories();\n  }\n\n  ngOnInit() {\n    this.formGroup = this.fb.group({\n      name: this.obj ? [this.obj.name, [Validators.required, Validators.minLength(4)]] : ['', [Validators.required, Validators.minLength(4)]],\n      content: this.obj ? [this.obj.content, Validators.required] : ['', [Validators.required]],\n      category: this.obj ? [this.obj.category, Validators.required] : ['', [Validators.required]],\n      image: ['', Validators.required]\n    });\n  }\n\n  get f() {\n    return this.formGroup.controls;\n  }\n\n  analizeObject() {\n    if (this.obj) {\n      this.create = false;\n    }\n  }\n\n  createOrEdit() {\n    var _a, _b, _c, _d, _e, _f;\n\n    if (this.create) {\n      this.api.post(environment.API_URL + 'news', false, {\n        name: (_a = this.formGroup.get('name')) === null || _a === void 0 ? void 0 : _a.value,\n        content: (_b = this.formGroup.get('content')) === null || _b === void 0 ? void 0 : _b.value,\n        image: this.imgBase64,\n        category_id: (_c = this.formGroup.get('category')) === null || _c === void 0 ? void 0 : _c.value\n      }).subscribe(res => {\n        console.log('post:', res);\n      });\n    } else {\n      this.api.put(environment.API_URL + 'news/' + this.obj.id, false, {\n        name: (_d = this.formGroup.get('name')) === null || _d === void 0 ? void 0 : _d.value,\n        content: (_e = this.formGroup.get('content')) === null || _e === void 0 ? void 0 : _e.value,\n        image: this.imgBase64,\n        category_id: (_f = this.formGroup.get('category')) === null || _f === void 0 ? void 0 : _f.value\n      }).subscribe(res => {\n        console.log('put: ', res);\n      });\n    }\n\n    this.show = !this.show;\n    setTimeout(() => {\n      this.show = !this.show;\n    }, 3000);\n    this.formGroup.reset();\n  }\n\n  fileOnChange(e) {\n    let imagen = e.target.files[0];\n    let allowedExtensions = /(.jpg|.png)$/i;\n\n    if (allowedExtensions.exec(imagen.name)) {\n      this.convertFileToBase64(imagen);\n    } else {\n      console.log(\"El archivo no es imagen\");\n      this.imgBase64 = null;\n      this.formGroup.controls.img.setErrors({\n        invalidExtension: true\n      });\n    }\n  }\n\n  convertFileToBase64(file) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = () => {\n        var _a;\n\n        _this.imgBase64 = (_a = reader.result) === null || _a === void 0 ? void 0 : _a.toString();\n      };\n    })();\n  }\n\n  getCategories() {\n    this.api.get(environment.API_URL + 'categories').subscribe(res => {\n      this.categorias = res.data;\n    });\n  }\n\n  changeCategory(event) {\n    var _a;\n\n    (_a = this.category) === null || _a === void 0 ? void 0 : _a.setValue(event.target.value);\n  }\n\n}\n\nNewsFormComponent.ɵfac = function NewsFormComponent_Factory(t) {\n  return new (t || NewsFormComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.HttpService));\n};\n\nNewsFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: NewsFormComponent,\n  selectors: [[\"app-news-form\"]],\n  inputs: {\n    obj: \"obj\"\n  },\n  decls: 27,\n  vars: 11,\n  consts: [[1, \"contenedor\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseBlock\", \"\"], [1, \"formulario\"], [3, \"formGroup\", \"ngSubmit\"], [\"for\", \"name\"], [\"type\", \"text\", \"formControlName\", \"name\", \"name\", \"name\"], [\"class\", \"error\", 4, \"ngIf\"], [\"for\", \"content\"], [\"data\", \"<p>Hello, world!</p>\", \"formControlName\", \"content\", \"name\", \"content\"], [\"for\", \"image\"], [\"type\", \"file\", \"formControlName\", \"image\", \"name\", \"image\", 3, \"change\"], [\"for\", \"category\"], [\"formControlName\", \"category\", 3, \"change\"], [\"class\", \"categoria\", 3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 3, \"disabled\", \"ngClass\", 4, \"ngIf\", \"ngIfElse\"], [\"editBlock\", \"\"], [\"class\", \"exito\", 4, \"ngIf\"], [1, \"error\"], [4, \"ngIf\"], [1, \"categoria\", 3, \"value\"], [\"type\", \"submit\", 3, \"disabled\", \"ngClass\"], [1, \"exito\"]],\n  template: function NewsFormComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, NewsFormComponent_h1_1_Template, 2, 0, \"h1\", 1);\n      i0.ɵɵtemplate(2, NewsFormComponent_ng_template_2_Template, 2, 0, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementStart(4, \"div\", 3)(5, \"form\", 4);\n      i0.ɵɵlistener(\"ngSubmit\", function NewsFormComponent_Template_form_ngSubmit_5_listener() {\n        return ctx.createOrEdit();\n      });\n      i0.ɵɵelementStart(6, \"label\", 5);\n      i0.ɵɵtext(7, \"T\\u00EDtulo de la novedad:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(8, \"input\", 6);\n      i0.ɵɵtemplate(9, NewsFormComponent_div_9_Template, 3, 2, \"div\", 7);\n      i0.ɵɵelementStart(10, \"label\", 8);\n      i0.ɵɵtext(11, \"Contenido:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(12, \"ckeditor\", 9);\n      i0.ɵɵtemplate(13, NewsFormComponent_div_13_Template, 2, 1, \"div\", 7);\n      i0.ɵɵelementStart(14, \"label\", 10);\n      i0.ɵɵtext(15, \"Foto:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(16, \"input\", 11);\n      i0.ɵɵlistener(\"change\", function NewsFormComponent_Template_input_change_16_listener($event) {\n        return ctx.fileOnChange($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(17, NewsFormComponent_div_17_Template, 2, 1, \"div\", 7);\n      i0.ɵɵelementStart(18, \"label\", 12);\n      i0.ɵɵtext(19, \"Categor\\u00EDa:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"select\", 13);\n      i0.ɵɵlistener(\"change\", function NewsFormComponent_Template_select_change_20_listener($event) {\n        return ctx.changeCategory($event);\n      });\n      i0.ɵɵtemplate(21, NewsFormComponent_option_21_Template, 2, 2, \"option\", 14);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(22, NewsFormComponent_div_22_Template, 2, 1, \"div\", 7);\n      i0.ɵɵtemplate(23, NewsFormComponent_button_23_Template, 2, 4, \"button\", 15);\n      i0.ɵɵtemplate(24, NewsFormComponent_ng_template_24_Template, 2, 4, \"ng-template\", null, 16, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵtemplate(26, NewsFormComponent_div_26_Template, 3, 2, \"div\", 17);\n      i0.ɵɵelementEnd()()();\n    }\n\n    if (rf & 2) {\n      const _r1 = i0.ɵɵreference(3);\n\n      const _r9 = i0.ɵɵreference(25);\n\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.create)(\"ngIfElse\", _r1);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"formGroup\", ctx.formGroup);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.f[\"name\"].touched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.f[\"content\"].touched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngIf\", ctx.f[\"image\"].touched);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.categorias);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.f[\"category\"].touched);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.create)(\"ngIfElse\", _r9);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.show);\n    }\n  },\n  dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf, i4.CKEditorComponent, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n  styles: [\".contenedor[_ngcontent-%COMP%] {\\n  padding: 20px;\\n  font-family: \\\"Poppins\\\", sans-serif;\\n  align-items: center;\\n}\\n\\nh1[_ngcontent-%COMP%] {\\n  text-align: center;\\n}\\n\\nselect[_ngcontent-%COMP%] {\\n  display: flex;\\n  margin-top: 30px;\\n}\\n\\n.formulario[_ngcontent-%COMP%] {\\n  align-items: center;\\n  display: flex;\\n  font-size: 20px;\\n  padding: 80px;\\n  justify-content: center;\\n}\\n\\nlabel[_ngcontent-%COMP%] {\\n  display: block;\\n  margin: 15px;\\n  margin-left: -2px;\\n}\\n\\nbutton[_ngcontent-%COMP%] {\\n  background-color: #FF0000;\\n  border-radius: 10px;\\n  color: white;\\n  display: block;\\n  font-family: \\\"Poppins\\\", sans-serif;\\n  font-size: 20px;\\n  margin-left: 250px;\\n  margin-top: 50px;\\n  padding: 10px;\\n}\\n\\ntable[_ngcontent-%COMP%] {\\n  font-size: 15px;\\n}\\n\\n.error[_ngcontent-%COMP%] {\\n  font-size: 15px;\\n  color: red;\\n}\\n\\n.btnError[_ngcontent-%COMP%] {\\n  background-color: grey;\\n}\\n\\n.exito[_ngcontent-%COMP%] {\\n  color: green;\\n  font-size: 20px;\\n  text-align: center;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5ld3MtZm9ybS5jb21wb25lbnQuc2NzcyIsIi4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcTnVldmElMjBjYXJwZXRhXFxPVDMwNC1jbGllbnRcXHNyY1xcYXBwXFxmZWF0dXJlc1xccGFnZXNcXG5ld3NcXG5ld3MtZm9ybVxcbmV3cy1mb3JtLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLGtDQUFBO0VBQ0EsbUJBQUE7QUNDSjs7QURFQTtFQUNJLGtCQUFBO0FDQ0o7O0FERUE7RUFDSSxhQUFBO0VBQ0EsZ0JBQUE7QUNDSjs7QURFQTtFQUNJLG1CQUFBO0VBQ0EsYUFBQTtFQUNBLGVBQUE7RUFDQSxhQUFBO0VBQ0EsdUJBQUE7QUNDSjs7QURFQTtFQUNJLGNBQUE7RUFDQSxZQUFBO0VBQ0EsaUJBQUE7QUNDSjs7QURFQTtFQUNJLHlCQUFBO0VBQ0EsbUJBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUNBLGtDQUFBO0VBQ0EsZUFBQTtFQUNBLGtCQUFBO0VBQ0EsZ0JBQUE7RUFDQSxhQUFBO0FDQ0o7O0FERUE7RUFDSSxlQUFBO0FDQ0o7O0FERUE7RUFDSSxlQUFBO0VBQ0EsVUFBQTtBQ0NKOztBREVBO0VBQ0ksc0JBQUE7QUNDSjs7QURFQTtFQUNJLFlBQUE7RUFDQSxlQUFBO0VBQ0Esa0JBQUE7QUNDSiIsImZpbGUiOiJuZXdzLWZvcm0uY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGVuZWRvcntcclxuICAgIHBhZGRpbmc6IDIwcHg7XHJcbiAgICBmb250LWZhbWlseTogJ1BvcHBpbnMnLCBzYW5zLXNlcmlmO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxufVxyXG5cclxuaDF7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbn1cclxuXHJcbnNlbGVjdHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBtYXJnaW4tdG9wOiAzMHB4O1xyXG59XHJcblxyXG4uZm9ybXVsYXJpb3tcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZm9udC1zaXplOiAyMHB4O1xyXG4gICAgcGFkZGluZzogODBweDtcclxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG59XHJcblxyXG5sYWJlbHtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgbWFyZ2luOiAxNXB4O1xyXG4gICAgbWFyZ2luLWxlZnQ6IC0ycHg7XHJcbn1cclxuXHJcbmJ1dHRvbntcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICNGRjAwMDA7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG4gICAgY29sb3I6d2hpdGU7XHJcbiAgICBkaXNwbGF5OiBibG9jaztcclxuICAgIGZvbnQtZmFtaWx5OiAnUG9wcGlucycsIHNhbnMtc2VyaWY7XHJcbiAgICBmb250LXNpemU6IDIwcHg7XHJcbiAgICBtYXJnaW4tbGVmdDogMjUwcHg7XHJcbiAgICBtYXJnaW4tdG9wOiA1MHB4O1xyXG4gICAgcGFkZGluZzogMTBweDtcclxufVxyXG5cclxudGFibGV7XHJcbiAgICBmb250LXNpemU6IDE1cHg7XHJcbn1cclxuXHJcbi5lcnJvcntcclxuICAgIGZvbnQtc2l6ZTogMTVweDtcclxuICAgIGNvbG9yOnJlZDtcclxufVxyXG5cclxuLmJ0bkVycm9ye1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogZ3JleTtcclxufVxyXG5cclxuLmV4aXRve1xyXG4gICAgY29sb3I6Z3JlZW47XHJcbiAgICBmb250LXNpemU6IDIwcHg7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbn0iLCIuY29udGVuZWRvciB7XG4gIHBhZGRpbmc6IDIwcHg7XG4gIGZvbnQtZmFtaWx5OiBcIlBvcHBpbnNcIiwgc2Fucy1zZXJpZjtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cblxuaDEge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5cbnNlbGVjdCB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIG1hcmdpbi10b3A6IDMwcHg7XG59XG5cbi5mb3JtdWxhcmlvIHtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgZGlzcGxheTogZmxleDtcbiAgZm9udC1zaXplOiAyMHB4O1xuICBwYWRkaW5nOiA4MHB4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbn1cblxubGFiZWwge1xuICBkaXNwbGF5OiBibG9jaztcbiAgbWFyZ2luOiAxNXB4O1xuICBtYXJnaW4tbGVmdDogLTJweDtcbn1cblxuYnV0dG9uIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI0ZGMDAwMDtcbiAgYm9yZGVyLXJhZGl1czogMTBweDtcbiAgY29sb3I6IHdoaXRlO1xuICBkaXNwbGF5OiBibG9jaztcbiAgZm9udC1mYW1pbHk6IFwiUG9wcGluc1wiLCBzYW5zLXNlcmlmO1xuICBmb250LXNpemU6IDIwcHg7XG4gIG1hcmdpbi1sZWZ0OiAyNTBweDtcbiAgbWFyZ2luLXRvcDogNTBweDtcbiAgcGFkZGluZzogMTBweDtcbn1cblxudGFibGUge1xuICBmb250LXNpemU6IDE1cHg7XG59XG5cbi5lcnJvciB7XG4gIGZvbnQtc2l6ZTogMTVweDtcbiAgY29sb3I6IHJlZDtcbn1cblxuLmJ0bkVycm9yIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogZ3JleTtcbn1cblxuLmV4aXRvIHtcbiAgY29sb3I6IGdyZWVuO1xuICBmb250LXNpemU6IDIwcHg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Validators","environment","i0","NewsFormComponent","constructor","fb","api","FormData","analizeObject","getCategories","ngOnInit","formGroup","group","name","obj","required","minLength","content","category","image","f","controls","create","createOrEdit","post","API_URL","get","_a","value","_b","imgBase64","category_id","_c","subscribe","res","console","log","put","id","_d","_e","_f","show","setTimeout","reset","fileOnChange","e","imagen","target","files","allowedExtensions","exec","convertFileToBase64","img","setErrors","invalidExtension","file","reader","FileReader","readAsDataURL","onload","result","toString","categorias","data","changeCategory","event","setValue","selectors","inputs","decls","vars","consts","template","ctx","_r1","_r9"],"sourceRoot":"","sources":["C:\\Users\\yisus\\Desktop\\Nueva carpeta\\OT304-client\\src\\app\\features\\pages\\news\\news-form\\news-form.component.ts","C:\\Users\\yisus\\Desktop\\Nueva carpeta\\OT304-client\\src\\app\\features\\pages\\news\\news-form\\news-form.component.html"],"sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { HttpService } from 'src/app/core/services/http.service';\r\nimport { environment } from 'src/environments/environment';\r\n\r\n@Component({\r\n  selector: 'app-news-form',\r\n  templateUrl: './news-form.component.html',\r\n  styleUrls: ['./news-form.component.scss']\r\n})\r\nexport class NewsFormComponent implements OnInit {\r\n\r\n  //  @Input() obj : any = {\r\n  //   id:2413,\r\n  //   name: \"nombreTest\",\r\n  //   image: \"http://ongapi.alkemy.org/storage/08smgSTyLf.png\",\r\n  //   content: \"<p>descripcionTest</p>\",\r\n  //   category_id: 2292\r\n  // };\r\n\r\n  @Input() obj : any;\r\n\r\n  categorias : any;\r\n  \r\n  formData : FormData = new FormData();\r\n  formGroup !: FormGroup;\r\n  name : string = '';\r\n  description : string = '';\r\n  imgBase64 !: any;\r\n  categoryId !: any;\r\n  create : boolean = true;\r\n  category : any;\r\n  show : boolean = false;\r\n\r\n  constructor(private fb : FormBuilder, private api : HttpService) {\r\n\r\n    this.analizeObject();\r\n    this.getCategories();\r\n\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n\r\n    this.formGroup = this.fb.group({\r\n      name: this.obj ? [this.obj.name, [Validators.required, Validators.minLength(4)]] :['', [Validators.required, Validators.minLength(4)]],\r\n      content: this.obj ? [this.obj.content, Validators.required] :  ['', [Validators.required]],\r\n      category: this.obj ? [this.obj.category, Validators.required] :  ['', [Validators.required]],\r\n      image: ['', Validators.required],\r\n    });\r\n\r\n  }\r\n\r\n  get f(){\r\n    return this.formGroup.controls;\r\n  }\r\n\r\n  analizeObject(){\r\n    if(this.obj){\r\n\r\n      this.create = false;\r\n    }\r\n  }\r\n\r\n  createOrEdit(){\r\n\r\n    if(this.create){\r\n\r\n      this.api.post(environment.API_URL + 'news',false, {\r\n        name: this.formGroup.get('name')?.value,\r\n        content:this.formGroup.get('content')?.value,\r\n        image: this.imgBase64,\r\n        category_id: this.formGroup.get('category')?.value\r\n      })\r\n      .subscribe((res : any)=>{\r\n        console.log('post:', res);\r\n        \r\n      });\r\n  \r\n    }\r\n    else{\r\n\r\n      this.api.put( environment.API_URL+ 'news/' + this.obj.id,false, {\r\n        name: this.formGroup.get('name')?.value,\r\n        content:this.formGroup.get('content')?.value,\r\n        image: this.imgBase64,\r\n        category_id: this.formGroup.get('category')?.value\r\n      })\r\n      .subscribe((res : any )=>{\r\n        console.log('put: ', res)\r\n      });\r\n      \r\n    }\r\n\r\n    this.show = !this.show;\r\n    setTimeout(() => {\r\n\r\n    this.show = !this.show;\r\n\r\n    }, 3000);\r\n\r\n    this.formGroup.reset();\r\n   \r\n  }\r\n\r\n  fileOnChange(e: any) {\r\n\r\n    let imagen = e.target.files[0];\r\n    let allowedExtensions = /(.jpg|.png)$/i;\r\n\r\n    if (allowedExtensions.exec(imagen.name)) {\r\n      this.convertFileToBase64(imagen);\r\n    }\r\n    else {\r\n      console.log(\"El archivo no es imagen\");\r\n      this.imgBase64 = null;\r\n      this.formGroup.controls.img.setErrors({\r\n        invalidExtension: true\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  async convertFileToBase64(file: any) {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => {\r\n      this.imgBase64 = reader.result?.toString();\r\n    };\r\n  }\r\n\r\n  getCategories(){\r\n    this.api.get(environment.API_URL + 'categories')\r\n    .subscribe((res:any)=>{\r\n      this.categorias = res.data;\r\n    });\r\n  }\r\n\r\n  changeCategory(event : any){\r\n    this.category?.setValue(event.target.value);\r\n  }\r\n\r\n}\r\n","<div class=\"contenedor\">\r\n    \r\n    <h1 *ngIf=\"create ; else elseBlock\">Cree su novedad</h1>\r\n    <ng-template #elseBlock> <h1> Edite su novedad </h1> </ng-template>\r\n    <div class=\"formulario\">\r\n        <form [formGroup]=\"formGroup\" (ngSubmit)=\"createOrEdit()\">\r\n\r\n            <label for=\"name\">Título de la novedad:</label>\r\n            <input type=\"text\" formControlName=\"name\"  name=\"name\"/>\r\n            \r\n            <div class=\"error\" *ngIf=\"f['name'].touched\">\r\n                <div class=\"error\" *ngIf=\"f['name'].errors?.['minlength']\">El nombre debe tener al menos 4 caracteres.</div>\r\n                <div *ngIf=\"f['name'].errors?.['required']\">El nombre es requerido.</div>\r\n            </div>\r\n\r\n            <label for=\"content\">Contenido:</label>\r\n            <ckeditor data=\"<p>Hello, world!</p>\" formControlName=\"content\"  name=\"content\"></ckeditor>\r\n\r\n            \r\n            <div class=\"error\" *ngIf=\"f['content'].touched\">\r\n                <div *ngIf=\"f['content'].errors?.['required']\">El contenido es requerido.</div>\r\n            </div>\r\n\r\n            <label for=\"image\">Foto:</label>\r\n            <input type=\"file\" formControlName=\"image\"  name=\"image\" (change)=\"fileOnChange($event)\" /> \r\n\r\n            <div class=\"error\" *ngIf=\"f['image'].touched\">\r\n                <div *ngIf=\"f['image'].errors?.['required']\">La imagen es obligatoria.</div>\r\n            </div>\r\n\r\n            <label for=\"category\">Categoría:</label>\r\n            <select formControlName=\"category\" (change)=\"changeCategory($event)\">\r\n                <option class=\"categoria\" *ngFor=\"let categoria of categorias\" [value]=\"categoria.id\">\r\n                    {{categoria.name}}\r\n                </option>\r\n            </select>\r\n            \r\n            <div class=\"error\" *ngIf=\"f['category'].touched\">\r\n                <div *ngIf=\"f['category'].errors?.['required']\">Seleccione una categoría.</div>\r\n            </div>\r\n            <button *ngIf=\"create; else editBlock\"  [disabled]=\"formGroup.invalid\" [ngClass]=\"{'btnError' : formGroup.invalid}\" type=\"submit\">Crear</button>\r\n            <ng-template #editBlock>\r\n                <button type=\"submit\" [disabled]=\"formGroup.invalid\" [ngClass]=\"{'btnError' : formGroup.invalid}\">Editar</button>\r\n            </ng-template>\r\n\r\n            <div class=\"exito\" *ngIf=\"show\">\r\n                <label *ngIf=\"create\">Novedad creada</label>\r\n                <label *ngIf=\"!create\">Novedad editada</label>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</div>\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}